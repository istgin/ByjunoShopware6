{% sw_extends '@Storefront/storefront/base.html.twig' %}

{% block base_content %}
    {% block page_checkout %}
        <div class="account-register">
            <div class="row">
                <div class="col-lg-12">
                    <div class="card register-card">
                        <div class="card-body">
                            <div class="card-title">
                                Byjuno invoice
                            </div>
                            <form action="{{ path('frontend.checkout.byjunosubmit') }}?returnurl={{ page["returnurl"] }}&orderid={{ page["orderid"] }}"
                                  class="register-form" method="post" id="proceed_byjuno_invoice"
                                  name="proceed_byjuno_invoice">
                                <div class="register-personal">
                                    {% if page["custom_gender_enable"] %}
                                        <label class="form-label"
                                               for="customPersonalSalutation">
                                            {{ "account.personalSalutationLabel"|trans|sw_sanitize }}{{ "general.required"|trans|sw_sanitize }}
                                        </label>
                                        <div class="form-row">
                                            <div class="form-group col-md-2 col-4">
                                                <select id="customPersonalSalutation"
                                                        class="custom-select"
                                                        name="customSlutationId"
                                                        required="required">
                                                    {% if not page['current_salutation'] %}
                                                        <option disabled="disabled"
                                                                selected="selected"
                                                                value="">
                                                            {{ "account.personalSalutationPlaceholder"|trans|sw_sanitize }}{{ "general.required"|trans|sw_sanitize }}
                                                        </option>
                                                    {% endif %}
                                                    {% for salutation in page["salutations"] %}
                                                        <option {% if salutation.id == page['current_salutation'] %}
                                                            selected="selected"
                                                        {% endif %}
                                                                value="{{ salutation.id }}">
                                                            {{ salutation.translated.displayName }}
                                                        </option>
                                                    {% endfor %}
                                                </select>
                                            </div>
                                        </div>
                                    {% endif %}
                                    {% if page["custom_bd_enable"] %}
                                        <label for="personalBirthday">
                                            {{ "account.personalBirthdayLabel"|trans|sw_sanitize }}{{ shopware.config.core.loginRegistration.birthdayFieldRequired ? "general.required"|trans|sw_sanitize }}*
                                        </label>
                                        <div class="form-row">
                                            <div class="form-group col-md-2 col-4">
                                                <select id="customPersonalBirthdayDay"
                                                        name="customBirthdayDay"
                                                        class="custom-select"
                                                        required="required">
                                                    {% if not page['current_year'] %}
                                                        <option selected="selected"
                                                                value="">
                                                            {{ "account.personalBirthdaySelectDay"|trans|sw_sanitize }}
                                                        </option>
                                                    {% endif %}
                                                    {% for day in range(1, 31) %}
                                                        <option value="{{ day }}"
                                                                {% if day == page['current_day']  %} selected="selected"{% endif %}>
                                                            {{ day }}
                                                        </option>
                                                    {% endfor %}
                                                </select>
                                            </div>
                                            <div class="form-group col-md-2 col-4">
                                                <select id="customBirthdayMonth" name="customBirthdayMonth"
                                                        class="custom-select"
                                                        required="required">
                                                    {% if not page['current_month']  %}
                                                        <option selected="selected"
                                                                value="">
                                                            {{ "account.personalBirthdaySelectMonth"|trans|sw_sanitize }}
                                                        </option>
                                                    {% endif %}
                                                    {% for month in range(1, 12) %}
                                                        <option value="{{ month }}"
                                                                {% if month == page['current_month']  %} selected="selected"{% endif %}>
                                                            {{ month }}
                                                        </option>
                                                    {% endfor %}
                                                </select>
                                            </div>
                                            <div class="form-group col-md-2 col-4">
                                                {% set currentYear = "now"|date('Y') - 17 %}
                                                {% set startYear = currentYear - 102 %}

                                                <select id="customBirthdayYear" name="customBirthdayYear"
                                                        class="custom-select"
                                                        required="required">
                                                    {% if not page['current_day']  %}
                                                        <option selected="selected"
                                                                value="">
                                                            {{ "account.personalBirthdaySelectYear"|trans|sw_sanitize }}
                                                        </option>
                                                    {% endif %}
                                                    {% for year in range(currentYear, startYear) %}
                                                        <option value="{{ year }}"
                                                                {% if year == page['current_year']  %} selected="selected"{% endif %}>
                                                            {{ year }}
                                                        </option>
                                                    {% endfor %}
                                                </select>
                                            </div>
                                        </div>
                                    {% endif %}
                                </div>
                                <script>
                                    var byjuno_submit = false;
                                    function byjuno_submit_fn() {
                                        {% if page["custom_gender_enable"] %}
                                        if (document.getElementById('customPersonalSalutation').value === "") {
                                            //error customPersonalSalutation empty
                                            return false;
                                        }
                                        {% endif %}
                                        {% if page["custom_bd_enable"] %}
                                            if (document.getElementById('customPersonalBirthdayDay').value === ""
                                            || document.getElementById('customBirthdayMonth').value === ""
                                            || document.getElementById('customBirthdayYear').value === "") {
                                                //error customPersonalBirthday  empty
                                                return false;
                                            }
                                        {% endif %}
                                        if (byjuno_submit === false) {
                                            byjuno_submit = true;
                                            setTimeout(function () {
                                                document.getElementById('proceed_byjuno_invoice').submit();
                                            }, 1);
                                        }
                                    }
                                </script>
                                <div class="register-submit" style="text-align: left">
                                    <button onclick="byjuno_submit_fn()" type="button" class="btn btn-primary btn-lg" form="proceed_byjuno_invoice" id="proceed_byjuno_invoice_button">
                                        Submit payment
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    {% endblock %}
{% endblock %}

